<html>
    <head>
        <title>myLibrary</title>
        <link rel="stylesheet" href="css/common.css">
        <link rel="stylesheet" href="css/reading_room.css">
        <link rel="stylesheet" href="css/join.css">
        <link rel="stylesheet" href="css/login.css">
        
        <script src="https://code.jquery.com/jquery-1.10.2.js"></script>
        
        <!-- Latest compiled and minified CSS -->
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

        <!-- Optional theme -->
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">
    
        <!-- Latest compiled and minified JavaScript -->
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
        <script src="https://code.jquery.com/jquery-1.10.2.js"></script>
        <script src="/socket.io/socket.io.js"></script>
    </head>
    <body>
        <header>
            <img src="img/logo.png">
            <div>
                <input type="button" value="회원가입" class="header_btn" id="join">
                <input type="button" value="로그인" class="header_btn" id="login">
            </div>
            <div>
                <input type="button" value="검색" class="header_btn" id="serch_btn">
                <input type="text" value="검색어를 입력하시오." id="serch_in">
            </div>
        </header>
        <nav>
            <div id="b_nav">도서리스트
            </div>
            <div id="r_nav">열람실
            </div>
            <div id="q_nav">질문하기
            </div>
            <div id="n_nav">공지사항
            </div>
            <div id="map_nav">찾아오시는길
            </div>
        </nav>
        </header>
        <div>
            열람실
        </div>
        <section id = "reading_room">
            <input type="button" value = "제 1 열람실" class="reading_room_btn" id="first_room">
            <input type="button" value = "제 2 열람실" class="reading_room_btn" id="second_room">
            <div id = "reading_seat_first">
                <script>
                    var num=0;
                    var socket = io.connect();
                    socket.on('reserver',function(data){
                        var $target = $('div[data-x = ' + data.x + '][data-y = '+ data.y + ']');
                        $target.removeClass('enable');
                        $target.addClass('disable');
                    });
                </script>
                <script>
                        var onClickSeat = function () {
                            var x = $(this).attr('data-x');
                            var y = $(this).attr('data-y');

                            if (confirm('좌석을 예약하시겠습니까')) {
                                $(this).off('click');
                                socket.emit('reserve', {
                                    x: x,
                                    y: y
                                });
                            } else {
                                alert('취소되었습니다');
                            }
                        };
                        $.getJSON('/readingroom/seats', { dummy: new Date().getTime() }, function (data) {
                            $.each(data, function (indexY, line) {
                                var $line = $('<div></div>').addClass('line');
                                $.each(line, function (indexX, seat) {
                                    var $output = $('<div></div>', {
                                        'class': 'seat',
                                        'data-x': indexX,
                                        'data-y': indexY
                                    });
                                    
                                     if (seat == 1) {
                                         $output.addClass('enable').on('click', onClickSeat);
                                     } else if (seat == 2) {
                                         $output.addClass('disable');
                                     }
                                    
                                     if($output.hasClass('enable')){
                                        $output.append(num);
                                        num++;
                                     }
                                    
                                     $output.appendTo($line);
                                });
                                
                                $line.appendTo("#reading_seat_first");  
                            });
                        });
                </script>
            </div>
        </section>
        <section id="join_modal">
            <div>
                <div id="join_section">
                    <h3>회원가입</h3>
                    <div>
                        <label>아이디</label>
                        <input type="text" style="width:50%;" value="아이디">
                        <input type="button" value="중복확인" id="id_check">
                    </div>
                    <div>
                        <label>비밀번호</label>
                        <input type="password">
                    </div>
                    <div>
                        <label>비밀번호 확인</label>
                        <input type="password">
                    </div>
                    <div>
                        <label>이름</label>
                        <input type="text" value="이름">
                    </div>
                    <div>
                        <label>전화번호</label>
                        <input type="text" value="전화번호">
                        <p>* 전화번호는 - 없이 입력해 주세요.</p>
                    </div>
                    <div>
                        <label>주소</label>
                        <input type="text" value="주소">
                    </div>
                </div>
                <div id="join_bottom">
                    <input type="button" value="회원가입">
                    <input type="button" value="닫기" id="join_close">
                </div>
            </div>
        </section>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
        <script src="js/common.js"></script>
        <script src="js/login_join.js"></script>
    </body>
</html>